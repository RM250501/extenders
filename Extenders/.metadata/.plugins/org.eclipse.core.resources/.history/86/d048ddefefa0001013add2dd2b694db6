
// エンドポイント
console.log(ec2_ip);
const ws = new WebSocket("ws://" + ec2_ip + ":8080/WebSocketSchool/chat");

$(function() {

	$(".chat-container").hide();

	$("#startBtn").click(function() {

		let userName = document.getElementById("userName");
		userName = userName.value;

		document.getElementById("greeting").innerText = "ようこそ " + userName + " さん (^^)/";
		ws.send("un" + userName);

		$(".container").hide();
		$(".chat-container").show();
	});

	$("#sendButton").click(function() {
		let messageInput = document.getElementById("messageInput");
		sendMessage(messageInput.value);
		messageInput.value = "";
	});
});

// サーバからメッセージを受信したときの処理
ws.onmessage = function(event) {
	let chatHistory = document.getElementById("chatHistory");
	chatHistory.value = chatHistory.value + event.data + "\n";
}

// サーバにメッセージを送るためのメソッド
function sendMessage(value) {
	setTimeout(function() {
		ws.send("me" + value);
	}, 300);
}
